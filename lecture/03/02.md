# 상태 훅

useState 훅 & 함수 컴포넌트에서의 상태관리

## 문제 제기

- 함수형 컴포넌트에서 상태를 관리해야한다.
- 상태가 바뀌면 다시 렌더링을 해야하는 방법을 찾아야한다.

## 1차 구현

```js
import { useState } from "react";

export const MyReact = (() => {
  let firstName;
  let isInitialized = false;

  const useName = (initialValue = "") => {
    const { forceUpdate } = useForceUpdate();

    if (!isInitialized) {
      firstName = initialValue;
      isInitialized = true;
    }

    const setFirstName = (value) => {
      if (firstName === value) return;
      firstName = value;
      forceUpdate();
    };

    return [firstName, setFirstName];
  };
  return { useName };
})();

export const useForceUpdate = () => {
  // 여기서만 useState 사용!
  const [value, setValue] = useState(1);
  const forceUpdate = () => setValue(value + 1);
  return { forceUpdate };
};

```

## 2차구현 - 다중 상태 관리


```js
// state 구현부
import React from "react";

export const MyReact = (() => {
  let memorizedState = [];
  let isInitialized = [];
  let cursor = 0;

  const useState = (initialValue = "") => {
    const { forceUpdate } = useForceUpdate();

    if (!isInitialized[cursor]) {
      memorizedState[cursor] = initialValue;
      isInitialized[cursor] = true;
    }

    const state = memorizedState[cursor];

    const setStateAt = (_cursor) => (nextState) => {
      if (state === nextState) return;
      memorizedState[_cursor] = nextState;
      forceUpdate();
    };

    const setState = setStateAt(cursor);

    cursor = cursor + 1;

    return [state, setState];
  };

  const useForceUpdate = () => {
    const [value, setValue] = React.useState(1);
    const forceUpdate = () => {
      setValue(value + 1);
      cursor = 0;
    };
    return { forceUpdate };
  };

  return { useState };
})();



// app
const NameField = () => {
  const [firstName, setFirstName] = MyReact.useState("사용자1");
  const [lastName, setLastName] = MyReact.useState("김");

  const handleChangeFirstName = (e) => {
    setFirstName(e.target.value);
  };
  const handleChangeLastName = (e) => {
    setLastName(e.target.value);
  };
  return (
    <>
      <input value={firstName} onChange={handleChangeFirstName} />
      <input value={lastName} onChange={handleChangeLastName} />
    </>
  );
};
```